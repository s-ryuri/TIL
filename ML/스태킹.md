# 스태킹

스태킹은 개별적인 여러 알고리즘을 서로 결합해 예측 결과를 도출한 뒤에 예측한 데이터를 기반으로 다시 예측을 수행하는 것이다. 즉 개별 알고리즘의 예측 결과 데이터 세트를 최종적인 메타 데이터 세트로 만들어 별도의 ML 알고리즘으로 최종 학습을 수행하고 테스트 데이터를 기반으로 다시 최종 예측을 수행하는 방식이다.

스태킹에는 두 종류의 모델이 필요하다. 첫 번째는 개별적인 기반 모델, 즉 여러 개의 모델
두 번째는 이 개별적인 모델의 예측 데이터를 학습 데이터로 만들어서 학습하는 모델이다.

스태킹 모델의 핵심은 여러 개별 모델의 예측 데이터를 각각 스태킹 형태로 결합해 최종 메타 모델의 학습용 피처 데이터 세트와 테스트용 피처 데이터 세트를 만드는 것이다.

간단한 그림으로 나타내면 아래와 같다.  

![image](https://user-images.githubusercontent.com/66999675/132518670-972c8496-d668-430e-8e46-1306e2bd891b.png)

여러 개의 모델에 대한 예측값을 합한 후 스태킹 형태로 쌓은 뒤 이에 대한 예측을 다시 수행한다.
좀 더 상세히 살펴보면 아래와 같다.

![image](https://user-images.githubusercontent.com/66999675/132518699-87d0e38b-1c53-4169-b5a5-ceed0a728346.png)  

M * N 데이터 세트에 스태킹 앙상블을 적용한다고 가정

학습에 사용할 ML 알고리즘 모델은 3개로 한다. 먼저 모델별로 각각 학습을 시키면 주황색, 노란색, 초록색인 M 개의 로우를 가진 1개의 레이블 값이 도출된다. 모델별로 도출된 예측 레이블 값을 다시 stacking 해서 새로운 데이터 세트를 만들고 이 스태킹 된 데이터 세트에 대해 최종 모델을 적용해 최종 예측을 하는 것이 스태킹 앙상블 모델이다.

